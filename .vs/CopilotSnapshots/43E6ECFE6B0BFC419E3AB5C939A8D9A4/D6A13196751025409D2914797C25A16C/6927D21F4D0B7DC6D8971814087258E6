using AutoMapper;
using Miski.Domain.Entities;
using Miski.Shared.DTOs;

namespace Miski.Application.Mappings;

public class MappingProfile : Profile
{
    public MappingProfile()
    {
        CreateMap<Negociacion, NegociacionDto>()
            .ForMember(dest => dest.PersonaNombre, opt => opt.MapFrom(src => $"{src.Persona.Nombre} {src.Persona.Apellidos}"))
            .ForMember(dest => dest.Estado, opt => opt.MapFrom(src => src.Estado.ToString()))
            .ForMember(dest => dest.Tipo, opt => opt.MapFrom(src => src.Tipo.ToString()));

        CreateMap<DetalleNegociacion, DetalleNegociacionDto>()
            .ForMember(dest => dest.ProductoNombre, opt => opt.MapFrom(src => src.Producto.Nombre));

        CreateMap<Producto, ProductoDto>()
            .ForMember(dest => dest.Categoria, opt => opt.MapFrom(src => src.Categoria.ToString()));

        CreateMap<Persona, PersonaDto>()
            .ForMember(dest => dest.TipoDocumento, opt => opt.MapFrom(src => src.TipoDocumento.ToString()))
            .ForMember(dest => dest.TipoPersona, opt => opt.MapFrom(src => src.TipoPersona.ToString()));
    }
}

// DTOs adicionales que necesitamos
public class ProductoDto
{
    public int Id { get; set; }
    public string Nombre { get; set; } = string.Empty;
    public string Descripcion { get; set; } = string.Empty;
    public string Codigo { get; set; } = string.Empty;
    public decimal PrecioUnitario { get; set; }
    public string UnidadMedida { get; set; } = string.Empty;
    public int StockMinimo { get; set; }
    public int StockActual { get; set; }
    public string Categoria { get; set; } = string.Empty;
}

public class PersonaDto
{
    public int Id { get; set; }
    public string Nombre { get; set; } = string.Empty;
    public string Apellidos { get; set; } = string.Empty;
    public string Email { get; set; } = string.Empty;
    public string Telefono { get; set; } = string.Empty;
    public string Documento { get; set; } = string.Empty;
    public string TipoDocumento { get; set; } = string.Empty;
    public string TipoPersona { get; set; } = string.Empty;
}